**Server Side Request Forgery. (SSRF)**

**Подделка запроса на стороне сервера**

Эта атака позволяет отправлять запросы от имени сервера к внешним или внутренним ресурсам системы без авторизованного доступа. К данной атаке уязвимы в веб-приложения которые взаимодействуют с сторонними сервисами или загружают данные по ссылкам. 

Что может делать SSRF 

- Обойти ограничения 
- Извлечь конфиденциальную информацию
- Прочитать локальные файлы 
- Получить доступ к всем внутренним ресурсам
- Просканировать внутреннюю сеть 

Причина всего этого - некорректная проверка данных. Если приложение при формировании запроса использует недостоверные внешние данные. Тогда шрек (злоумышленник) может отправлять запросы дочерним ресурсам приложения через его основной сервер. Напрямую он связаться с дочерними ресурсами приложения не может по той или иной причине.

Есть мнение что SSRF  также может быть следствием XXE - атаки.

Предотвратить SSRF

Настройки сервера:
- Разбить сеть на сегменты и ограничить доступ к ресурсам за их пределами для снижения влияния SSRF.
- Применение политики брандмауэра "запретить по умолчанию" для фильтрации трафика.
  
Код:
- Проверка всех входных данных, предоставленных пользователем.
- Используйте схему URL-адреса, порт и место назначения с положительным списком разрешений.

Classification:
--

- ASVS 4.0.3 -> 5.2.6 и 12.6.1
- A10 - 2021 [OWASP]
- CWE - 918

